START_CONVERSATION:IS_INTIMIDATING:"Listen up!":>FORCE_CONVERSATION
START_CONVERSATION:!IS_INTIMIDATING,IS_NEUTRAL:"You got time to talk?":>WANTS_CONVERSATION
START_CONVERSATION:!IS_INTIMIDATING,!IS_NEUTRAL:"Hey.":>GREETING
ESTABLISH_RELATIONSHIP:@ALWAYS:$GET_INTRODUCTION_MESSAGE:>%*$GET_INTRODUCTION_GIST%

#Reactions
TRUST:@ALWAYS:"Just passing through.":>END
FEIGN_TRUST_FAILED:@ALWAYS:"(Lie) Sounds good.":>ESTABLISH_FEIGN_TRUST
AGGRESSIVE_RESPONSE:@ALWAYS:"Are you sure about that?":>STOOD_UP_TO,ESTABLISH_AGRESSIVE
AGGRESSIVE_RESPONSE:@ALWAYS:"I'm out of here.":>END,ESTABLISH_SCARED

ESTABLISH_TRUST:@ALWAYS:"Good to meet you.":ESTABLISH_TRUST,INFORM_OF_GROUP,>END
ESTABLISH_FEIGN_TRUST:@ALWAYS:"Good to meet you.":ESTABLISH_FEIGN_TRUST,INFORM_OF_GROUP,>END
ESTABLISH_AGRESSIVE:@ALWAYS:"Bad move!":ESTABLISH_AGRESSIVE,>END
ESTABLISH_HOSTILE:@ALWAYS:"You messed with the wrong person!":ESTABLISH_HOSTILE,>END
ESTABLISH_SCARED:@ALWAYS:"Okay, I'm out of here!":ESTABLISH_SCARED,>END

WANTS_CONVERSATION:@ALWAYS:"Sure!":>CONVERSATION
FORCE_CONVERSATION:@ALWAYS:"Okay...":>CONVERSATION
CONVERSATION:IS_INTIMIDATING,@IS_PLAYER:"(Intimidate) Demand info on target.":>ORDER_KILL,NEXT_GIST="GIVE_ORDER_TO_DESCRIBE_TARGET",TARGET=$GET_TARGET
CONVERSATION:IS_INTIMIDATING,@HAS_THREATS,!@IS_PLAYER:"(Intimidate) Demand info on target.":>ORDER_KILL,NEXT_GIST="GIVE_ORDER_TO_DESCRIBE_TARGET",TARGET=$GET_TARGET
CONVERSATION:!HAS_QUESTIONS_FOR_TARGET:>ASK_ABOUT_RECENT_EVENTS:>TALK_ABOUT_RECENT_EVENTS
CONVERSATION:!HAS_QUESTIONS_FOR_TARGET,@IS_GROUP_LEADER,!IS_IN_SAME_GROUP:"Looking for a group?":>ANSWER_RECRUIT,GROUP_ID=@$GET_GROUP
CONVERSATION:!HAS_QUESTIONS_FOR_TARGET:"Feel like trading?":>END
CONVERSATION:!HAS_QUESTIONS_FOR_TARGET,HAS_ORDERS_FOR_TARGET,@IS_GROUP_LEADER,IS_IN_SAME_GROUP:"%*$GIVE_TARGET_ORDER_MESSAGE%":>%*$GIVE_TARGET_ORDER%
CONVERSATION:HAS_QUESTIONS_FOR_TARGET:>%*$ASK_TARGET_QUESTION%:>END
CONVERSATION:!HAS_QUESTIONS_FOR_TARGET:"Nevermind.":>END
CONVERSATION:@IS_PLAYER,IS_IN_SAME_GROUP,@IS_GROUP_LEADER:"I have work for you.":>TALK_ABOUT_GROUP_ORDERS
CONVERSATION:@IS_PLAYER,!SEEN_TARGET_RECENTLY:"Where are you?":>GET_LOCATION
CONVERSATION:@IS_PLAYER:"I'm under attack!":>END,NEXT_GIST="ATTACKED_BY_HOSTILE",HOSTILE=$GET_TARGET
CONVERSATION:@IS_PLAYER:"Inform of group":>END,NEXT_GIST="INFORM_OF_KNOWN_GROUP",GROUP_ID=$GET_KNOWN_GROUP
INFORM_OF_KNOWN_GROUP:@ALWAYS:"Did you know about group %GROUP_ID%?":>HANDLE_INFORM_OF_KNOWN_GROUP
HANDLE_INFORM_OF_KNOWN_GROUP:!@^KNOWS_ABOUT_GROUP:"First I'm hearing of it.":>END,@^DISCOVER_GROUP
HANDLE_INFORM_OF_KNOWN_GROUP:@^KNOWS_ABOUT_GROUP,!^@IS_GROUP_HOSTILE:"I've heard of them.":>END
HANDLE_INFORM_OF_KNOWN_GROUP:@^KNOWS_ABOUT_GROUP,^@IS_GROUP_HOSTILE,^IS_TARGET_IN_GROUP:"Back off!":>ESTABLISH_HOSTILE,ESTABLISH_HOSTILE
HANDLE_INFORM_OF_KNOWN_GROUP:@^KNOWS_ABOUT_GROUP,^@IS_GROUP_HOSTILE,!^IS_TARGET_IN_GROUP:"We hate those guys!":>END

RECRUIT:@ALWAYS:"Are you looking for a group?":>ANSWER_RECRUIT
ANSWER_RECRUIT:!IS_COMBAT_TARGET,@IS_IN_GROUP,@WANTS_TO_LEAVE_GROUP_FOR_GROUP,!@IS_PLAYER:"Possibly. What's the plan?":>TALK_ABOUT_GROUP_MOTIVES
ANSWER_RECRUIT:!IS_COMBAT_TARGET,@IS_IN_GROUP,!@WANTS_TO_LEAVE_GROUP_FOR_GROUP,!@IS_PLAYER:"I'll pass.":>REJECT_RECRUIT
ANSWER_RECRUIT:!IS_COMBAT_TARGET,!@IS_IN_GROUP,!@IS_PLAYER:"Possibly. What's the plan?":>TALK_ABOUT_GROUP_MOTIVES
ANSWER_RECRUIT:IS_COMBAT_TARGET,!@IS_GROUP_LEADER,!@IS_PLAYER:"Wrong question!":>ESTABLISH_HOSTILE
ANSWER_RECRUIT:IS_COMBAT_TARGET,@IS_GROUP_LEADER,!@IS_PLAYER:"Do you even know who I am?":>ESTABLISH_HOSTILE
ANSWER_RECRUIT:@IS_PLAYER:"Possibly. What's the plan?":>TALK_ABOUT_GROUP_MOTIVES
ANSWER_RECRUIT:@IS_PLAYER,@IS_IN_GROUP:"I'm in a group.":>TARGET_IS_IN_GROUP,GROUP_ID=@$GET_GROUP,&@^DISCOVER_GROUP,&^ADD_TARGET_TO_KNOWN_GROUP
ANSWER_RECRUIT:@IS_PLAYER:"I'll pass.":>REJECT_RECRUIT
ANSWER_RECRUIT:@IS_PLAYER:"Wrong question!":>ESTABLISH_HOSTILE
REJECT_RECRUIT:@ALWAYS:"Your loss.":>END
TARGET_IS_IN_GROUP:IS_TARGET_GROUP_HOSTILE:"Back off then!":>ESTABLISH_HOSTILE,ESTABLISH_HOSTILE
TARGET_IS_IN_GROUP:IS_TARGET_GROUP_FRIENDLY:"Good to hear. We're on good terms with them.":>ESTABLISH_TRUST,ESTABLISH_TRUST
TARGET_IS_IN_GROUP:IS_TARGET_GROUP_NEUTRAL:"Interesting.":>END
LAST_SEEN_TARGET:@ALWAYS:"Where was the last place you saw <%TARGET_ID%>?":>UPDATE_LAST_SEEN_TARGET
UPDATE_LAST_SEEN_TARGET:!@IS_PLAYER,@^SAW_TARGET_RECENTLY:"I've updated your PDA.":>UPDATE_TARGET_LOCATION
UPDATE_LAST_SEEN_TARGET:!@IS_PLAYER,!@^SAW_TARGET_RECENTLY:"I haven't seen them recently.":>END
UPDATE_LAST_SEEN_TARGET:@IS_PLAYER:"I've updated your PDA.":>UPDATE_TARGET_LOCATION
UPDATE_LAST_SEEN_TARGET:@IS_PLAYER:"I haven't seen them recently.":>END
UPDATE_TARGET_LOCATION:@ALWAYS:"":>END,^UPDATE_LOCATION_OF_TARGET_FROM_TARGET

CONFRONT:@IS_RAIDING,!@IS_PLAYER:"You're done for!":>INTIMIDATION
CONFRONT:!@IS_RAIDING,!@IS_PLAYER:"(Tension) Is there an issue?":>CONFRONT_ISSUE
CONFRONT:!@HAS_USABLE_WEAPON,!@IS_PLAYER:"I'm out of here.":>END,ESTABLISH_SCARED
CONFRONT_ISSUE:@IS_IN_GROUP,!@IS_GROUP_MOTIVATED_FOR_CRIME:"Depends. Are you with anyone?":>ASK_FOR_RELATED_TARGETS
CONFRONT_ISSUE:@IS_IN_GROUP,@IS_GROUP_MOTIVATED_FOR_CRIME,@IS_IN_SHELTER:"You're the one violating our space.":>ASK_TO_LEAVE,GROUP_ID=@$GET_GROUP
CONFRONT_ISSUE:@IS_IN_GROUP,@IS_GROUP_MOTIVATED_FOR_CRIME,!@IS_IN_SHELTER:"We don't answer to anyone!":>GROUP_IS_HOSTILE,GROUP_ID=@$GET_GROUP,ESTABLISH_HOSTILE
CONFRONT_ISSUE:!@IS_IN_GROUP:"I'm just passing through.":>ACCEPT_INTIMIDATION
CONFRONT_ISSUE:!@IS_IN_GROUP:"Who are you exactly?":>END
ASK_FOR_RELATED_TARGETS:@IS_IN_GROUP,!@IS_GROUP_MOTIVATED_FOR_CRIME:"I'm with a group. We're not here for conflict.":>GROUP_IS_NOT_HOSTILE,GROUP_ID=@$GET_GROUP,FORCE_INFORM_OF_GROUP
GROUP_IS_NOT_HOSTILE:@ALWAYS:"Okay.":>ESTABLISH_TRUST,ESTABLISH_TRUST,@^DECLARE_GROUP_TRUSTED
ASK_TO_LEAVE:@IS_IN_GROUP,@IS_GROUP_MOTIVATED_FOR_CRIME:"And we don't care.":>GROUP_IS_HOSTILE,@^DECLARE_GROUP_HOSTILE
INTIMIDATION:!@HAS_USABLE_WEAPON,!@IS_PLAYER:"Okay. I'm out of here.":>ACCEPT_INTIMIDATION
INTIMIDATION:!@HAS_USABLE_WEAPON,!@IS_PLAYER:"I'm with you!":>QUESTION_INTIMIDATION
INTIMIDATION:@HAS_USABLE_WEAPON,!@IS_PLAYER:"Bad move!":>ESTABLISH_HOSTILE,ESTABLISH_HOSTILE
INTIMIDATION:@IS_PLAYER:"Okay. I'm out of here.":>ACCEPT_INTIMIDATION,ESTABLISH_SCARED
INTIMIDATION:@IS_PLAYER:"Bad move!":>ESTABLISH_HOSTILE,ESTABLISH_HOSTILE
ACCEPT_INTIMIDATION:@ALWAYS,!TARGET_IS_COMBAT_READY:"Okay.":>END,ESTABLISH_TRUST,&ESTABLISH_TRUST
ACCEPT_INTIMIDATION:@ALWAYS,TARGET_IS_COMBAT_READY:"I don't want to see you around here again.":>END
QUESTION_INTIMIDATION:@ALWAYS,TARGET_IS_COMBAT_READY:"Put down the gun!":>DEMAND_LOWER_WEAPON
DEMAND_LOWER_WEAPON:@ALWAYS:Okay.:>END
DEMAND_LOWER_WEAPON:@ALWAYS:No thanks!:>ESTABLISH_HOSTILE,ESTABLISH_HOSTILE
CONFRONT_AGAIN:@ALWAYS:"I've already told you to get out of here once.":>END
CONFRONT_BREAK:@ALWAYS:"You're done!":>ESTABLISH_HOSTILE,ESTABLISH_HOSTILE

TALK_ABOUT_GROUP_MOTIVES:@ALWAYS:"There's strength in numbers.":>REACT_TO_GROUP_MOTIVES
TALK_ABOUT_GROUP_MOTIVES:@ALWAYS:"We can make lots of money together.":>REACT_TO_GROUP_MOTIVES
REACT_TO_GROUP_MOTIVES:@ALWAYS:"That sounds interesting. I'm in.":>ACCEPT_JOIN_GROUP,@^DISCOVER_GROUP,@^JOIN_GROUP
ACCEPT_JOIN_GROUP:@ALWAYS:"Welcome!":>END,ADD_GROUP_MEMBER,CLAIM_TO_BE_GROUP_LEADER,^INFORM_OF_GROUP_MEMBERS
GROUP_EXISTS:@ALWAYS:"I'm a member of <group>":>DISCOVER_GROUP,GROUP_ID=@$GET_GROUP
DISCOVER_GROUP:^@KNOWS_ABOUT_GROUP:"I knew that!":>END
DISCOVER_GROUP:!^@KNOWS_ABOUT_GROUP:"I didn't know that!":>END,@^DISCOVER_GROUP,^ADD_TARGET_TO_KNOWN_GROUP
GROUP_LIST:@ALWAYS:"<Updated member list of group %GROUP_ID%>":>END,&^UPDATE_GROUP_MEMBERS
ASK_FOR_GROUP_LIST:@ALWAYS:"Do you know anybody in group %GROUP_ID%?:>INFORM_OF_GROUP_MEMBERS
INFORM_OF_GROUP_MEMBERS:@^KNOWS_ABOUT_GROUP:"Yeah...":>END,^INFORM_OF_GROUP_MEMBERS
INFORM_OF_GROUP_MEMBERS:!@^KNOWS_ABOUT_GROUP:"Never heard of them.":>END
GROUP_IS_HOSTILE:@ALWAYS:"Group %GROUP_ID% has crossed the line!":>CLAIM_GROUP_IS_HOSTILE
CLAIM_GROUP_IS_HOSTILE:@ALWAYS:"Copy!":>END,^@DECLARE_GROUP_HOSTILE
CLAIM_GROUP_IS_HOSTILE:@ALWAYS:"Loud and clear.":>END,^@DECLARE_GROUP_HOSTILE

GROUP_LEADER_STATE_CHANGE:@ALWAYS:"":>END,&@RESET_THINK_TIMER

#NEW_GROUP_MEMBER:@ALWAYS:"We have a new guy in our ranks."

GREETING:IS_IN_SAME_GROUP:"What's up?":>CONVERSATION
GREETING:IS_IN_SAME_GROUP,IS_TARGET_GROUP_LEADER:"Orders?":>CONVERSATION
GREETING:@ALWAYS:"Hello.":>CONVERSATION
GREETING:@ALWAYS:"Hi.":>CONVERSATION

GREETING_RESPONSE:@ALWAYS:>@GREETING:>END
ASK_ABOUT_RECENT_EVENTS:@ALWAYS:"Anything new?":>TALK_ABOUT_RECENT_EVENTS
ASK_ABOUT_RECENT_EVENTS:@ALWAYS:"What have you been up to recently?":>TALK_ABOUT_RECENT_EVENTS
TALK_ABOUT_RECENT_EVENTS:@ALWAYS:$@GET_RECENT_EVENTS:>END

TALK_ABOUT_GROUP_ORDERS:@HAS_NEEDS_TO_MEET:"I'm busy right now.":>HANDLE_REJECTION,REJECT=TALK_ABOUT_GROUP_ORDERS
TALK_ABOUT_GROUP_ORDERS:!@HAS_NEEDS_TO_MEET:"Yes?":>ORDERS

HANDLE_REJECTION:@ALWAYS:"Maybe you should reconsider that.":>RECONSIDER

ORDERS:@ALWAYS:"Kill...":>ORDER_KILL,NEXT_GIST="GIVE_ORDER_TO_KILL_TARGET",TARGET=GET_TARGET
GIVE_ORDER_TO_KILL_TARGET:@ALWAYS:"I need this person eliminated.":>REACT_TO_KILL_TARGET_ORDER
GIVE_ORDER_TO_DESCRIBE_TARGET:@ALWAYS:"Tell me more about...":>DESCRIBE_TARGET
REACT_TO_KILL_TARGET_ORDER:@ALWAYS:"I can do that.":>END
DESCRIBE_TARGET:@ALWAYS:"%*^$DESCRIBE_TARGET%":>END
COMBAT_READY:@ALWAYS:"Are you combat ready?":>IS_COMBAT_READY
IS_COMBAT_READY:@IS_PLAYER:"Yes.":>CONFIRM_COMBAT_READY
IS_COMBAT_READY:@IS_PLAYER:"No.":>REJECT_COMBAT_READY
IS_COMBAT_READY:@HAS_USABLE_WEAPON,!@IS_PLAYER:"Yes.":>CONFIRM_COMBAT_READY
IS_COMBAT_READY:!@HAS_USABLE_WEAPON,!@IS_PLAYER:"No.":>REJECT_COMBAT_READY
CONFIRM_COMBAT_READY:@ALWAYS:"":>END,MARK_TARGET_AS_COMBAT_READY
REJECT_COMBAT_READY:@ALWAYS:"":>END,MARK_TARGET_AS_NOT_COMBAT_READY

RECONSIDER:@ALWAYS:>%REJECT%:>RECONSIDERED

GIVE_ORDER:@ALWAYS:"%*$GIVE_TARGET_ORDER_MESSAGE%":>%*$GIVE_TARGET_ORDER%
JOB:@ALWAYS:"I can do it.":>JOB_ACCEPT
JOB:@ALWAYS:"No thanks.":>JOB_DENY

JOB_ACCEPT:@ALWAYS:"Awesome.":TAKE_ORDER,>END
JOB_DENY:@ALWAYS:"Too bad.":REJECT_ORDER,>END

CALL_ACCEPTED:@ALWAYS:"What can I help you with?":>CONVERSATION

GET_LOCATION:@ALWAYS:"I am near %*@$GET_LOCATION%.":>END,UPDATE_LOCATION

ATTACKED_BY_HOSTILE:@ALWAYS:"Help! This maniac is attacking me!":>RESPOND_TO_ATTACK_BY_HOSTILE
RESPOND_TO_ATTACK_BY_HOSTILE:@ALWAYS:"I'm coming!":^CLAIM_HOSTILE,>END

#Groups
#UPDATE_GROUP_LEADER:@IS_LEADER_OF_GROUP:"
UPDATE_GROUP_SHELTER:@ALWAYS:"This is where we'll be meeting.":>SET_GROUP_SHELTER,GROUP=$@GET_GROUP,SHELTER=$@GET_GROUP_SHELTER
SET_GROUP_SHELTER:@ALWAYS:"Understood.":>END,^@SET_GROUP_SHELTER
UPDATE_GROUP_STAGE:@ALWAYS:$@GET_GROUP_STAGE_MESSAGE:>SET_GROUP_STAGE,GROUP=$@GET_GROUP,STAGE=$@GET_GROUP_STAGE
SET_GROUP_STAGE:@ALWAYS:"Understood.":>END,^@SET_GROUP_STAGE
RESOURCE_CHECK:@ALWAYS:"Do you need any supplies?":>NEEDS_SUPPLIES
NEEDS_SUPPLIES:!@IS_PLAYER,@HAS_UNMET_NEEDS:"I could use some things...":>END
NEEDS_SUPPLIES:!@IS_PLAYER,!@HAS_UNMET_NEEDS:"I should be okay for now.":>END
NEEDS_SUPPLIES:@IS_PLAYER:"I could use...":>END,NEXT_GIST="ASK_FOR_SUPPLIES",ITEMS=$GET_NEEDS
NEEDS_SUPPLIES:@IS_PLAYER:"I'm fine for now.":>END
ASK_FOR_SUPPLIES:@ALWAYS:"I need...":>RESPOND_TO_ASK_FOR_SUPPLIES
RESPOND_TO_ASK_FOR_SUPPLIES:@^KNOWS_ITEMS_MATCHING:^INFORM_OF_ITEMS:>END
RESPOND_TO_ASK_FOR_SUPPLIES:!@^KNOWS_ITEMS_MATCHING:"Can't help you there.":>END

#Group phrases/shouts
FOUND_SHELTER:@ALWAYS:"I've found us a place to stay.":>END
PREPARE_FOR_RAID:@ALWAYS:"We might be heading out soon.":>END
